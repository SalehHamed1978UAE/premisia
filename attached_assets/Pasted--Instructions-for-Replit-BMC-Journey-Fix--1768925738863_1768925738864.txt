 Instructions for Replit: BMC Journey Fix                                      
                                                                                
  The Architecture (DO NOT BYPASS)                                              
                                                                                
  server/journey/journey-registry.ts     → Defines journey sequences            
  server/journey/journey-orchestrator.ts → Executes modules in order            
  server/journey/strategic-context-accumulator.ts → Passes data between modules 
  server/routes/strategic-consultant.ts  → SSE streams module-specific data     
                                                                                
  What's Broken                                                                 
                                                                                
  The frontend (ResearchPage.tsx, ResearchExperience.tsx) ignores the journey   
  registry and has hardcoded logic that assumes Porter's Five Forces.           
                                                                                
  The Fixes (in order)                                                          
                                                                                
  1. ResearchPage.tsx must use the journey registry                             
                                                                                
  // REMOVE hardcoded category arrays                                           
  // ADD: Query the current framework from the journey                          
  import { getJourneyByType } from '@/lib/journey-client';                      
                                                                                
  const journey = getJourneyByType(journeyType);                                
  const currentFramework = journey.frameworks[currentFrameworkIndex];           
                                                                                
  // Render module-specific UI based on currentFramework                        
  if (currentFramework === 'bmc') {                                             
    return <BMCResearchExperience {...props} />;                                
  } else if (currentFramework === 'porters') {                                  
    return <PortersResearchExperience {...props} />;                            
  }                                                                             
                                                                                
  2. Create BMCResearchExperience.tsx                                           
                                                                                
  This component renders the 9 BMC blocks during research. It should:           
  - Listen to SSE events with type: 'synthesis' and block field                 
  - Display: customer_segments, value_propositions, revenue_streams, channels,  
  customer_relationships, key_resources, key_activities, key_partnerships,      
  cost_structure                                                                
  - NOT share code with Porter's component                                      
                                                                                
  3. Fix strategic-consultant.ts routing                                        
                                                                                
  At line ~2162, replace hardcoded URL:                                         
  // WRONG:                                                                     
  nextUrl: `/strategy-workspace/decisions/${sessionId}/${versionNumber}`        
                                                                                
  // RIGHT:                                                                     
  import { getNextPage } from '../journey/journey-registry';                    
  const journey = getJourneyByType('business_model_innovation');                
  const nextUrl = getNextPage(journey,                                          
  '/strategic-consultant/research/:sessionId', { sessionId, versionNumber });   
                                                                                
  4. Add regression test                                                        
                                                                                
  // tests/journeys/bmc-journey.spec.ts                                         
  describe('BMC Journey', () => {                                               
    it('renders 9 BMC blocks during research', async () => {                    
      const journey = getJourneyByType('business_model_innovation');            
      expect(journey.frameworks).toContain('bmc');                              
                                                                                
      // Simulate SSE and verify BMC blocks render                              
      const blocks = ['customer_segments', 'value_propositions', ...];          
      // Assert each block appears in UI                                        
    });                                                                         
                                                                                
    it('routes to correct page after research', async () => {                   
      const nextUrl = getNextPage(journey, currentPage, params);                
      expect(nextUrl).toMatch(/\/bmc\/results\//);                              
    });                                                                         
  });                                                                           
                                                                                
  The Rule                                                                      
                                                                                
  Every time you touch journey/research code:                                   
  1. Check journey-registry.ts for the source of truth                          
  2. Use getNextPage() instead of hardcoding URLs                               
  3. Render module-specific UI based on currentFramework                        
  4. Run npm run test:journeys before committing                                
                                                